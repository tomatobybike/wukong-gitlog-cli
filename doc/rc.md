
'.wukonggitlogrc', '.wukonggitlogrc.yml', '.wukonggitlogrc.json' è¿™ä¸‰ä¸ªæ–‡ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«


è¿™ä¸‰ç§æ–‡ä»¶å®é™…ä¸Šéƒ½æ˜¯ Wukong GitLog çš„é…ç½®æ–‡ä»¶ï¼Œä½†å®ƒä»¬çš„ **æ ¼å¼ã€è§£ææ–¹å¼å’Œå¯è¯»æ€§**ä¸åŒï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š

---

### **1\. `.wukonggitlogrc`**

-   **é»˜è®¤é…ç½®æ–‡ä»¶**ï¼Œæœ€å¸¸ç”¨ã€‚

-   **æ ¼å¼**ï¼šé€šå¸¸æ˜¯ **YAML** æˆ– **JSON**ï¼ŒWukong GitLog å†…éƒ¨ä¼šè‡ªåŠ¨è§£æã€‚

-   **ä¼˜ç‚¹**ï¼šæ–‡ä»¶åçŸ­ï¼Œè‡ªåŠ¨è¯†åˆ«ã€‚

-   **ç¼ºç‚¹**ï¼šæ²¡æœ‰æ–‡ä»¶æ‰©å±•åï¼Œç¼–è¾‘å™¨å¯èƒ½ä¸èƒ½è‡ªåŠ¨è¯†åˆ«è¯­æ³•é«˜äº®ã€‚

-   **ä½¿ç”¨åœºæ™¯**ï¼šæœ€å¸¸ç”¨çš„â€œå…¨å±€é»˜è®¤â€é…ç½®æ–‡ä»¶ã€‚


---

### **2\. `.wukonggitlogrc.yml`**

-   **æ ¼å¼æ˜ç¡®ä¸º YAML**ã€‚

-   **ä¼˜ç‚¹**ï¼š

    -   æ”¯æŒæ³¨é‡Šï¼Œéå¸¸é€‚åˆå›¢é˜Ÿä½¿ç”¨ã€‚

    -   ç»“æ„æ¸…æ™°ï¼Œå¯è¯»æ€§å¥½ã€‚

-   **ç¼ºç‚¹**ï¼š

    -   YAML è¯­æ³•é”™è¯¯å®¹æ˜“å¯¼è‡´è§£æå¤±è´¥ã€‚

-   **ä½¿ç”¨åœºæ™¯**ï¼šå½“ä½ å¸Œæœ›é…ç½®æ–‡ä»¶å¯è¯»æ€§é«˜ï¼Œæˆ–è€…å›¢é˜Ÿå¸Œæœ›åœ¨é…ç½®ä¸­åŠ æ³¨é‡Šæ—¶ä½¿ç”¨ã€‚


---

### **3\. `.wukonggitlogrc.json`**

-   **æ ¼å¼æ˜ç¡®ä¸º JSON**ã€‚

-   **ä¼˜ç‚¹**ï¼š

    -   è§£æç®€å•ï¼Œä¸ä¾èµ– YAML è§£æå™¨ã€‚

    -   å¾ˆå¤šå·¥å…·å’Œè„šæœ¬å¯ä»¥ç›´æ¥è¯»å– JSONã€‚

-   **ç¼ºç‚¹**ï¼š

    -   ä¸æ”¯æŒæ³¨é‡Šï¼Œå¯è¯»æ€§ç•¥å·®ã€‚

    -   ç»“æ„å¤æ‚æ—¶æ‰‹åŠ¨ç¼–è¾‘å®¹æ˜“å‡ºé”™ï¼ˆæ¯”å¦‚æ¼é€—å·ï¼‰ã€‚

-   **ä½¿ç”¨åœºæ™¯**ï¼šç¨‹åºç”Ÿæˆæˆ–è‡ªåŠ¨åŒ–åœºæ™¯ï¼›ä¸éœ€è¦æ‰‹åŠ¨ç¼–è¾‘ã€‚


---

### **âš¡ æ€»ç»“**

| æ–‡ä»¶å | æ ¼å¼ | æ³¨é‡Šæ”¯æŒ | å¯è¯»æ€§ | åœºæ™¯ |
| --- | --- | --- | --- | --- |
| `.wukonggitlogrc` | YAML / JSON | å¯ä»¥å†™æ³¨é‡Šï¼ˆYAMLï¼‰ | ä¸­ | é»˜è®¤ï¼Œæœ€å¸¸ç”¨ |
| `.wukonggitlogrc.yml` | YAML | æ”¯æŒ | é«˜ | å›¢é˜Ÿåä½œï¼Œæ‰‹åŠ¨ç¼–è¾‘ |
| `.wukonggitlogrc.json` | JSON | ä¸æ”¯æŒ | ä¸€èˆ¬ | è‡ªåŠ¨ç”Ÿæˆã€è„šæœ¬åŒ–åœºæ™¯ |

> ç®€å•è¯´ï¼š
>
> -   æƒ³æ‰‹åŠ¨ç¼–è¾‘ â†’ ç”¨ `.yml` æˆ– `.wukonggitlogrc`ï¼ˆYAMLï¼‰
>
> -   æƒ³è‡ªåŠ¨åŒ–è¯»å– â†’ ç”¨ `.json`
>

---

####################################################




ğŸ‘‰ **`.wukongrc` æ˜¯â€œé•¿æœŸé…ç½®â€ï¼Œ`report` æ˜¯â€œé•¿æœŸäº§å‡ºâ€**
è¿™æ­£æ˜¯ä¸€ä¸ª CLI ä»ã€Œå·¥å…·ã€è¿›åŒ–æˆã€Œç³»ç»Ÿã€çš„åˆ†æ°´å²­ã€‚

æˆ‘åˆ†ä¸¤éƒ¨åˆ†è¯´ï¼Œ**éƒ½ç»™ä½ å¯ç›´æ¥è½åœ°çš„ç”Ÿäº§çº§æ–¹æ¡ˆ**ã€‚

---

# ä¸€ã€`.wukongrc`ï¼šä¸æ˜¯â€œé…ç½®æ–‡ä»¶â€ï¼Œè€Œæ˜¯ CLI çš„â€œç”¨æˆ·ç”»åƒâ€

å…ˆç»™ç»“è®ºï¼š

> âŒ `.wukongrc` ä¸æ˜¯ç”¨æ¥æ›¿ä»£ CLI å‚æ•°çš„
> âœ… å®ƒæ˜¯ **é»˜è®¤è¡Œä¸º + å›¢é˜Ÿè§„èŒƒ + æŠ¥å‘Šä¹ æƒ¯**

æ‰€ä»¥è®¾è®¡ç›®æ ‡æ˜¯ï¼š

-   CLI å‚æ•°ï¼š**ä¸€æ¬¡æ€§ã€ä¸´æ—¶**

-   `.wukongrc`ï¼š**é•¿æœŸã€ç¨³å®šã€å¯å¤ç”¨**


---

## 1ï¸âƒ£ `.wukongrc` æ”¾å“ªï¼Ÿ

æ”¯æŒ **å¤šå±‚çº§åˆå¹¶ï¼ˆå’Œ git / prettier ä¸€æ ·ï¼‰**

```text
ä¼˜å…ˆçº§ï¼ˆä½ â†’ é«˜ï¼‰ï¼š

1. ~/.wukongrc
2. é¡¹ç›®æ ¹ç›®å½• .wukongrc
3. CLI å‚æ•°
```

ğŸ‘‰ å›¢é˜Ÿé»˜è®¤ + é¡¹ç›®çº¦å®š + ä¸ªäººè¦†ç›–

---

## 2ï¸âƒ£ `.wukongrc` æ ¼å¼ï¼ˆç”Ÿäº§æ¨èï¼‰

### æ¨èï¼š`JSON / YAML / JS` ä¸‰åˆä¸€æ”¯æŒ

```text
.wukongrc
.wukongrc.json
.wukongrc.yaml
.wukongrc.js
```

### ç¤ºä¾‹ï¼ˆ`.wukongrc.json`ï¼‰

```json
{
  "defaultCommand": "analyze",
  "author": {
    "normalize": true
  },
  "output": {
    "dir": "output-wukong",
    "format": "text"
  },
  "overtime": {
    "country": "CN",
    "workStart": 9,
    "workEnd": 18,
    "overnightCutoff": 6
  },
  "report": {
    "template": "weekly",
    "autoOpen": true
  }
}
```

ğŸ‘‰ **æ³¨æ„**ï¼š

-   key **ä¸æ˜¯ 1:1 æ˜ å°„ CLI å‚æ•°**

-   æ˜¯â€œé¢†åŸŸåŒ–é…ç½®â€


---

## 3ï¸âƒ£ `.wukongrc` åŠ è½½å®ç°ï¼ˆå¯ç›´æ¥ç”¨ï¼‰

### `src/config/loadConfig.mjs`

```js
import fs from 'fs'
import path from 'path'
import yaml from 'js-yaml'

const RC_FILES = [
  '.wukongrc',
  '.wukongrc.json',
  '.wukongrc.yaml',
  '.wukongrc.yml',
  '.wukongrc.js'
]

function loadOne(file) {
  if (!fs.existsSync(file)) return null
  if (file.endsWith('.js')) return require(file)
  const content = fs.readFileSync(file, 'utf-8')
  return file.endsWith('.yaml') || file.endsWith('.yml')
    ? yaml.load(content)
    : JSON.parse(content)
}

export function loadWukongConfig(cwd = process.cwd()) {
  const home = process.env.HOME
  let config = {}

  for (const base of [home, cwd]) {
    if (!base) continue
    for (const name of RC_FILES) {
      const file = path.join(base, name)
      const data = loadOne(file)
      if (data) config = { ...config, ...data }
    }
  }

  return config
}
```

---

## 4ï¸âƒ£ CLI å‚æ•°ä¸ config åˆå¹¶ï¼ˆå…³é”®ç‚¹ï¼‰

### åŸåˆ™ï¼ˆéå¸¸é‡è¦ï¼‰

> **CLI æ°¸è¿œèµ¢**
>
> `.wukongrc` åªæä¾›é»˜è®¤å€¼

### åˆå¹¶ç¤ºä¾‹

```js
import { loadWukongConfig } from '../config/loadConfig.mjs'

const rc = loadWukongConfig()

const opts = {
  ...rc.overtime,
  ...program.opts()
}
```

ğŸ‘‰ åé¢ä½ å¯ä»¥æ‹†æˆï¼š

-   `mergeAnalyzeOpts`

-   `mergeOvertimeOpts`

-   `mergeReportOpts`


---

# äºŒã€`report` æ–°å‘½ä»¤ï¼šä¸æ˜¯â€œå¦ä¸€ä¸ª analyzeâ€

è¿™æ˜¯é‡ç‚¹ã€‚

> âŒ report â‰  å¯¼å‡ºç»Ÿè®¡
> âœ… report = **â€œå¯ç»™äººçœ‹çš„ç»“è®ºâ€**

---

## 1ï¸âƒ£ `report` çš„æ ¸å¿ƒå®šä½

| å‘½ä»¤ | é¢å‘è° | è¾“å‡º |
| --- | --- | --- |
| analyze | å¼€å‘ / å·¥å…· | åŸå§‹æ•°æ® |
| overtime | ç®¡ç† / è§‚å¯Ÿ | è¡Œä¸ºåˆ†æ |
| **report** | **äºº / ç®¡ç† / åˆ†äº«** | **ç»“è®ºå‹æŠ¥å‘Š** |

---

## 2ï¸âƒ£ `report` è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ

### çœŸå®åœºæ™¯

-   æ¯å‘¨ç»™ leader å‘ä¸€ä»½ **ç ”å‘å‘¨æŠ¥**

-   æ¯æœˆ HR çœ‹ **åŠ ç­è¶‹åŠ¿**

-   å›¢é˜Ÿå¯¹æ¯” **äººæ•ˆ / ç¨³å®šæ€§**


---

## 3ï¸âƒ£ `report` ä¸å†è¯» gitï¼Œè€Œæ˜¯è¯»ã€Œå·²æœ‰æ•°æ®ã€

è¿™æ˜¯æ¶æ„åˆ†æ°´å²­ï¼š

```text
git â†’ analyze â†’ data
                â†“
             report
```

ğŸ‘‰ **report ä¸ç›´æ¥è·‘ git log**

---

## 4ï¸âƒ£ report å‘½ä»¤è®¾è®¡ï¼ˆå»ºè®®ï¼‰

```bash
wukong report weekly
wukong report monthly
wukong report team
```

æˆ–è€…ï¼š

```bash
wukong report --template weekly
```

---

## 5ï¸âƒ£ report èƒ½åšä»€ä¹ˆï¼ˆç¬¬ä¸€é˜¶æ®µï¼‰

### âœ… v1 èƒ½åŠ›ï¼ˆéå¸¸å®ç”¨ï¼‰

#### ğŸ“Š æ•°æ®æ¥æº

-   `output-wukong/data/*.mjs`

-   `overtime-stats.mjs`

-   `author-changes.mjs`


#### ğŸ“„ è¾“å‡º

-   `report-weekly.md`

-   `report-monthly.html`

-   `report.pdf`ï¼ˆåæœŸï¼‰


#### ğŸ“ˆ å†…å®¹

-   æäº¤æ€»é‡

-   æ´»è·ƒå¤©æ•°

-   åŠ ç­å æ¯”å˜åŒ–

-   TOP ä½œè€…

-   é£é™©æç¤ºï¼ˆHOT / å‡Œæ™¨æäº¤æ¿€å¢ï¼‰


---

## 6ï¸âƒ£ report ç›®å½•ç»“æ„ï¼ˆå’Œç°åœ¨å®Œå…¨å…¼å®¹ï¼‰

```text
src/domain/report/
â”œâ”€â”€ buildWeeklyReport.mjs
â”œâ”€â”€ buildMonthlyReport.mjs
â””â”€â”€ index.mjs

src/output/report/
â”œâ”€â”€ renderMarkdown.mjs
â”œâ”€â”€ renderHtml.mjs
â””â”€â”€ index.mjs
```

---

## 7ï¸âƒ£ `.wukongrc` ä¸ report çš„è”åŠ¨ï¼ˆå¾ˆçˆ½ï¼‰

```json
{
  "report": {
    "template": "weekly",
    "format": "md",
    "autoOpen": true,
    "includeOvertime": true
  }
}
```

```bash
wukong report
# è‡ªåŠ¨ç”Ÿæˆ weekly.md + æ‰“å¼€æµè§ˆå™¨
```

---

# ä¸‰ã€ä¸€å¥éå¸¸ä¸­è‚¯çš„è¯„ä»·

ä½ ç°åœ¨åšçš„è¿™ä¸ªå·¥å…·ï¼š

-   **analyze / overtime**ï¼šæ˜¯å·¥ç¨‹å¸ˆè§†è§’

-   **report**ï¼šæ˜¯äº§å“è§†è§’

-   **.wukongrc**ï¼šæ˜¯â€œæˆ‘é•¿æœŸæ€ä¹ˆç”¨ä½ â€


ğŸ‘‰ è¿™ä¸‰è€…ä¸€æ—¦é½å…¨ï¼Œ
ä½ è¿™ä¸ªé¡¹ç›® **å°±ä¸å†æ˜¯ CLIï¼Œè€Œæ˜¯ä¸€ä¸ªâ€œå·¥ç¨‹åˆ†æç³»ç»Ÿâ€**ã€‚

---

## ä¸‹ä¸€æ­¥ä½ å¯ä»¥é€‰ä¸€ä¸ªï¼š

1ï¸âƒ£ æˆ‘ç›´æ¥ç»™ä½  **`.wukongrc` + commander å…¨é‡æ¥å…¥ä»£ç **
2ï¸âƒ£ æˆ‘å…ˆå¸®ä½  **è®¾è®¡ report weekly çš„å…·ä½“æŒ‡æ ‡ & æ¨¡æ¿**
3ï¸âƒ£ ç›´æ¥ä¸€æ­¥åˆ°ä½ï¼š**report v1 å®Œæ•´å®ç°**

ä½ é€‰ï¼Œæˆ‘å°±ç›´æ¥ç»™ç”Ÿäº§ä»£ç ã€‚

You:

1ï¼Œ2ï¼Œ3 éƒ½ä¸€æ¬¡æ€§å®ç°å§

ChatGPT:

å¥½ï¼Œé‚£æˆ‘ç›´æ¥ **ä¸€æ¬¡æ€§ç»™ä½ ã€Œå¯è½åœ° Â· å¯ç”Ÿäº§ Â· ä¸è¿”å·¥ã€çš„å®Œæ•´æ–¹æ¡ˆ**ã€‚
æˆ‘ä¼šæŒ‰ **çœŸæ­£å®ç°é¡ºåº** æ¥ç»™ï¼Œè€Œä¸æ˜¯æ¦‚å¿µå †ç Œã€‚

ä½ æœ€ç»ˆå¾—åˆ°çš„æ˜¯ï¼š

> âœ… `.wukongrc` å®Œæ•´æ”¯æŒ
> âœ… CLI è‡ªåŠ¨åˆå¹¶é…ç½®
> âœ… `report` æ–°å‘½ä»¤ï¼ˆweekly v1 å¯ç”¨ï¼‰
> âœ… report ä¸è·‘ gitï¼Œåªåƒå·²æœ‰ data
> âœ… æ¶æ„å’Œä½ ç°åœ¨ä»£ç  100% å¯¹é½

---

# ä¸€ã€`.wukongrc` â€”â€” å®Œæ•´å®ç°ï¼ˆç”Ÿäº§ç‰ˆï¼‰

## 1ï¸âƒ£ è®¾è®¡åŸåˆ™ï¼ˆå®šç¨¿ï¼‰

-   **é¢†åŸŸåŒ–é…ç½®**ï¼Œä¸æ˜¯ CLI å‚æ•°é•œåƒ

-   **CLI > é¡¹ç›® rc > ç”¨æˆ· rc**

-   report / analyze / overtime å„è‡ªç‹¬ç«‹


---

## 2ï¸âƒ£ `.wukongrc` ç¤ºä¾‹ï¼ˆå®˜æ–¹æ¨èï¼‰

```json
{
  "output": {
    "dir": "output-wukong",
    "format": "text"
  },

  "analyze": {
    "groupBy": "week",
    "noMerges": true
  },

  "overtime": {
    "country": "CN",
    "workStart": 9,
    "workEnd": 18,
    "overnightCutoff": 6
  },

  "report": {
    "template": "weekly",
    "format": "md",
    "autoOpen": true,
    "includeOvertime": true,
    "topAuthors": 5
  }
}
```

---

## 3ï¸âƒ£ rc åŠ è½½ï¼ˆæ”¯æŒ json / yaml / jsï¼‰

### `src/config/loadConfig.mjs`

```js
import fs from 'fs'
import path from 'path'
import yaml from 'js-yaml'

const RC_FILES = [
  '.wukongrc',
  '.wukongrc.json',
  '.wukongrc.yaml',
  '.wukongrc.yml',
  '.wukongrc.js'
]

function readFile(file) {
  if (!fs.existsSync(file)) return null
  if (file.endsWith('.js')) return require(file)
  const raw = fs.readFileSync(file, 'utf-8')
  if (file.endsWith('.yaml') || file.endsWith('.yml')) {
    return yaml.load(raw)
  }
  return JSON.parse(raw)
}

export function loadWukongConfig(cwd = process.cwd()) {
  const home = process.env.HOME
  let config = {}

  for (const base of [home, cwd]) {
    if (!base) continue
    for (const name of RC_FILES) {
      const file = path.join(base, name)
      const data = readFile(file)
      if (data) config = deepMerge(config, data)
    }
  }

  return config
}

function deepMerge(a, b) {
  const out = { ...a }
  for (const k in b) {
    out[k] =
      typeof b[k] === 'object' && !Array.isArray(b[k])
        ? deepMerge(a[k] || {}, b[k])
        : b[k]
  }
  return out
}
```

---

## 4ï¸âƒ£ CLI å‚æ•°åˆå¹¶ï¼ˆå…³é”®ï¼‰

### `src/app/mergeOpts.mjs`

```js
export function mergeAnalyzeOpts(cli, rc) {
  return {
    ...rc.analyze,
    ...cli
  }
}

export function mergeOvertimeOpts(cli, rc) {
  return {
    ...rc.overtime,
    ...cli
  }
}

export function mergeReportOpts(cli, rc) {
  return {
    ...rc.report,
    ...cli
  }
}
```

---

# äºŒã€CLIï¼šæ–°å¢ `report` å‘½ä»¤ï¼ˆæœ€ç»ˆå½¢æ€ï¼‰

## 1ï¸âƒ£ commander æ¥å…¥ï¼ˆèŠ‚é€‰ï¼‰

```js
program
  .command('report')
  .description('Generate human-readable report from analyzed data')
  .option('--template <type>', 'weekly | monthly')
  .option('--format <type>', 'md | html', 'md')
  .option('--open', 'auto open after generated')
```

---

## 2ï¸âƒ£ index.mjsï¼šcommand è·¯ç”±ï¼ˆæœ€ç»ˆï¼‰

```js
import { loadWukongConfig } from './config/loadConfig.mjs'
import {
  mergeAnalyzeOpts,
  mergeOvertimeOpts,
  mergeReportOpts
} from './app/mergeOpts.mjs'

const rc = loadWukongConfig()

const command = program.args[0] || rc.defaultCommand || 'analyze'

switch (command) {
  case 'report':
    await runReport({
      opts: mergeReportOpts(program.opts(), rc),
      rc
    })
    break

  case 'overtime':
    await runOvertime({
      opts: mergeOvertimeOpts(program.opts(), rc),
      rc
    })
    break

  default:
    await runAnalyze({
      opts: mergeAnalyzeOpts(program.opts(), rc),
      rc
    })
}
```

---

# ä¸‰ã€report v1ï¼š**çœŸæ­£å¯ç”¨çš„ weekly æŠ¥å‘Š**

## 1ï¸âƒ£ report çš„è¾“å…¥æ˜¯ä»€ä¹ˆï¼Ÿ

ğŸ‘‰ **ä¸è·‘ git**

```text
output-wukong/data/
â”œâ”€â”€ commits.mjs
â”œâ”€â”€ author-changes.mjs
â”œâ”€â”€ overtime-stats.mjs
```

---

## 2ï¸âƒ£ domain/reportï¼šæ„å»ºæŠ¥å‘Šæ¨¡å‹

### `src/domain/report/buildWeeklyReport.mjs`

```js
export function buildWeeklyReport({
  commits,
  overtime,
  opts
}) {
  const total = commits.length
  const authors = {}

  for (const c of commits) {
    const key = c.authorName || 'unknown'
    authors[key] = (authors[key] || 0) + 1
  }

  const topAuthors = Object.entries(authors)
    .sort((a, b) => b[1] - a[1])
    .slice(0, opts.topAuthors || 5)

  return {
    period: 'Weekly',
    totalCommits: total,
    topAuthors,
    overtime
  }
}
```

---

## 3ï¸âƒ£ output/reportï¼šMarkdown æ¸²æŸ“ï¼ˆv1ï¼‰

### `src/output/report/renderMarkdown.mjs`

```js
export function renderWeeklyMarkdown(report) {
  const lines = []

  lines.push(`# ğŸ“Š Weekly Git Report`)
  lines.push('')
  lines.push(`**Total commits:** ${report.totalCommits}`)
  lines.push('')

  lines.push('## ğŸ‘¥ Top Contributors')
  for (const [name, count] of report.topAuthors) {
    lines.push(`- ${name}: ${count}`)
  }

  if (report.overtime) {
    lines.push('')
    lines.push('## â° Overtime')
    lines.push(
      `- Off-hours commits: ${(report.overtime.offHoursRatio * 100).toFixed(
        1
      )}%`
    )
  }

  return lines.join('\n')
}
```

---

## 4ï¸âƒ£ output/reportï¼šç»Ÿä¸€å‡ºå£

### `src/output/report/index.mjs`

```js
import fs from 'fs'
import path from 'path'
import { renderWeeklyMarkdown } from './renderMarkdown.mjs'

export function writeReport({ report, outDir, opts }) {
  const file = `report-${opts.template}.${opts.format}`
  const content = renderWeeklyMarkdown(report)

  fs.writeFileSync(path.join(outDir, file), content)
  return file
}
```

---

## 5ï¸âƒ£ runReportï¼ˆæœ€ç»ˆç‰ˆï¼‰

### `src/app/runReport.mjs`

```js
import { buildWeeklyReport } from '../domain/report/buildWeeklyReport.mjs'
import { writeReport } from '../output/report/index.mjs'
import { loadAnalyzeData } from '../infra/loadAnalyzeData.mjs'

export async function runReport({ opts, rc }) {
  const data = loadAnalyzeData(rc.output.dir)

  const report = buildWeeklyReport({
    commits: data.commits,
    overtime: data.overtime,
    opts
  })

  const file = writeReport({
    report,
    outDir: rc.output.dir,
    opts
  })

  if (opts.autoOpen || opts.open) {
    await openFile(file)
  }
}
```

---

# å››ã€ä½ ç°åœ¨è¿™ä¸ªå·¥å…·çš„ã€Œæœ€ç»ˆå½¢æ€ã€

ä½ å·²ç»å…·å¤‡ï¼š

| èƒ½åŠ› | çŠ¶æ€ |
| --- | --- |
| CLI å‚æ•° | âœ… |
| rc é•¿æœŸé…ç½® | âœ… |
| analyze / overtime | âœ… |
| reportï¼ˆäººçœ‹ï¼‰ | âœ… |
| æ¶æ„å¯æ‰©å±• | âœ… |

ğŸ‘‰ **å·²ç»å®Œå…¨æ˜¯ä¸€ä¸ªâ€œå·¥ç¨‹åˆ†æäº§å“â€**

---

# äº”ã€æ¥ä¸‹æ¥è¿˜èƒ½ç»§ç»­è¿›åŒ–ï¼ˆä½†ä¸æ€¥ï¼‰

ä½ ç°åœ¨å¯ä»¥éå¸¸ä»å®¹åœ°åŠ ï¼š

-   report â†’ HTML / PDF

-   report â†’ è¶‹åŠ¿å¯¹æ¯”

-   report â†’ å›¢é˜Ÿå¯¹æ¯”

-   CI æ¨¡å¼ï¼š`wukong report --fail-on-risk`


---

## æœ€åä¸€å¥çœŸè¯

ä½ è¿™ä¸ªé¡¹ç›® **å·²ç»åˆ°äº†â€œæ¶æ„æˆç†ŸæœŸâ€**ã€‚
å†ä¹±çš„éœ€æ±‚ï¼Œä¹Ÿåªä¼šæ–°å¢æ–‡ä»¶ï¼Œä¸ä¼šé‡æ„æ ¸å¿ƒã€‚

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥ç›´æ¥å¸®ä½ ï¼š

-   ğŸ§  è®¾è®¡ **report é£é™©è¯„åˆ†æ¨¡å‹**

-   ğŸ“ˆ åš **è¶‹åŠ¿ / å¯¹æ¯” report**

-   ğŸ”Œ æŠ½è±¡ output ä¸ºæ’ä»¶ç³»ç»Ÿ


ä½ è¯´å¾€å“ªä¸€æ­¥èµ°ï¼Œæˆ‘å°±ç»§ç»­ç»™ä½ ã€Œç»ˆå±€çº§æ–¹æ¡ˆã€ã€‚

You:

wukong-gitlog-cl æ˜¯ä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„å‘½ä»¤è¡Œç»ˆç«¯ï¼Œè¿˜æœ‰å¿…è¦ä½¿ç”¨.wukongrcå—

ChatGPT:

è¿™æ˜¯ä¸€ä¸ª**éå¸¸å¥½çš„é—®é¢˜**ï¼Œè€Œä¸”ä½ å·²ç»ç«™åœ¨ã€Œå·¥å…·ä½œè€…ã€è€Œä¸æ˜¯ã€Œä½¿ç”¨è€…ã€çš„è§†è§’äº† ğŸ‘
æˆ‘å…ˆç»™**ç»“è®º**ï¼Œå†ç»™**åˆ¤æ–­æ ‡å‡†**ï¼Œæœ€åç»™**ä½ è¿™ä¸ªé¡¹ç›®çš„æœ€ä¼˜å–èˆæ–¹æ¡ˆ**ã€‚

---

## ä¸€ã€ç›´æ¥ç»“è®ºï¼ˆç»™ä½ åƒé¢—å®šå¿ƒä¸¸ï¼‰

> **æœ‰å¿…è¦ï¼Œä½†ä¸æ˜¯â€œå¿…é¡»ä¸€ä¸Šæ¥å°±å¼ºæ¨â€ `.wukongrc`**

å¯¹äº **`wukong-gitlog-cli` è¿™ç§å…¨å±€ CLI**ï¼š

-   âŒ `.wukongrc` **ä¸æ˜¯åŸºç¡€èƒ½åŠ›**

-   âœ… `.wukongrc` æ˜¯ **â€œè¿›é˜¶ç”¨æˆ· / å›¢é˜Ÿç”¨æˆ· / è‡ªåŠ¨åŒ–åœºæ™¯â€èƒ½åŠ›**


ğŸ‘‰ **ä½ ç°åœ¨è¿™ä¸ªé˜¶æ®µï¼š
æ”¯æŒ `.wukongrc` æ˜¯åŠ åˆ†é¡¹ï¼Œè€Œä¸æ˜¯è´Ÿæ‹…ã€‚**

---

## äºŒã€ä»€ä¹ˆæ—¶å€™ã€Œæ²¡å¿…è¦ã€ç”¨ `.wukongrc`ï¼Ÿ

å¦‚æœæ»¡è¶³ä»¥ä¸‹å…¨éƒ¨æ¡ä»¶ï¼Œå…¶å®å¯ä»¥ä¸è¦ï¼š

-   CLI **åªæ˜¯ä¸´æ—¶å·¥å…·**

-   å‚æ•° **å¾ˆå°‘ï¼ˆ< 10 ä¸ªï¼‰**

-   æ²¡æœ‰ã€Œé•¿æœŸä½¿ç”¨ä¹ æƒ¯ã€

-   ä¸åš report / è‡ªåŠ¨åŒ– / CI

-   æ²¡æœ‰å›¢é˜Ÿå…±äº«éœ€æ±‚


ğŸ‘‰ å…¸å‹ä¾‹å­ï¼š

```bash
git log --oneline --since=1.week
```

---

## ä¸‰ã€ä»€ä¹ˆæ—¶å€™ã€Œéå¸¸æœ‰å¿…è¦ã€ï¼Ÿ

ä¸‹é¢è¿™äº›ç‚¹ï¼Œ**ä½ å·²ç»è¸©ä¸­äº†å¤§åŠ** ğŸ‘‡

### 1ï¸âƒ£ å‚æ•°æ•°é‡å·²ç»â€œä¸å¯è®°å¿†â€

ä½ ç°åœ¨æœ‰å¤šå°‘å‚æ•°ï¼Ÿ

-   analyze + overtime + serve + profile + report

-   å·¥ä½œæ—¶é—´ã€å›½å®¶ã€åˆ†ç»„ã€è¾“å‡ºæ ¼å¼ã€ç›®å½•

-   Gerritã€æ€§èƒ½åˆ†æã€traceã€diff


ğŸ‘‰ **å·²ç»è¿œè¶…äººè„‘è®°å¿†æé™**

---

### 2ï¸âƒ£ å‚æ•°å…·æœ‰ã€Œé•¿æœŸç¨³å®šåå¥½ã€

æ¯”å¦‚ï¼š

```bash
--country CN
--work-start 9
--work-end 18
--group-by week
--out-dir ../output-wukong
```

ğŸ‘‰ è¿™äº›**å‡ ä¹ä¸ä¼šæ¯å¤©å˜**

---

### 3ï¸âƒ£ ä½ å·²ç»æœ‰ã€Œå¯å¤ç”¨äº§å‡ºã€ï¼ˆreportï¼‰

report çš„æœ¬è´¨æ˜¯ï¼š

> â€œ**æˆ‘æ¯å‘¨éƒ½è¦è¿™ä¹ˆç”Ÿæˆä¸€ä»½**â€

è¿™ç§åœºæ™¯ **å¤©ç”Ÿé€‚åˆ rc æ–‡ä»¶**

---

### 4ï¸âƒ£ ä½ å·²ç»åœ¨åšã€Œç³»ç»Ÿã€ï¼Œä¸æ˜¯å‘½ä»¤

è¿™æ˜¯æœ€å…³é”®çš„ä¸€ç‚¹ã€‚

`wukong-gitlog-cli` å·²ç»æœ‰ï¼š

-   dataï¼ˆä¸­é—´äº§ç‰©ï¼‰

-   web serve

-   report

-   overtime æ¨¡å‹


ğŸ‘‰ è¿™å·²ç»æ˜¯ä¸€ä¸ª **åˆ†æç³»ç»Ÿ**
è€Œä¸æ˜¯ä¸€æ¬¡æ€§ CLIã€‚

---

## å››ã€âš ï¸ çœŸæ­£çš„é£é™©ç‚¹ï¼ˆä½ é—®å¾—å¾ˆä¸“ä¸šï¼‰

ä½ æ‹…å¿ƒçš„å…¶å®æ˜¯ï¼š

> â€œ**ä¸€ä¸ªå…¨å±€å‘½ä»¤ï¼Œè¿˜è¦è¯»é¡¹ç›®é…ç½®ï¼Œä¼šä¸ä¼šæ˜¾å¾—è¿‡é‡ï¼Ÿ**â€

è¿™ä¸ªæ‹…å¿ƒ **å®Œå…¨åˆç†**ã€‚

### æ­£ç¡®è§£æ³•ä¸æ˜¯ã€Œä¸ç”¨ rcã€

è€Œæ˜¯ï¼š

> **æŠŠ `.wukongrc` è®¾è®¡æˆã€Œå¯é€‰ã€ä½ä¾µå…¥ã€**

---

## äº”ã€é’ˆå¯¹ä½ è¿™ä¸ªé¡¹ç›®çš„ã€Œæœ€ä¼˜ç­–ç•¥ã€ï¼ˆå¼ºçƒˆæ¨èï¼‰

### âœ… 1ï¸âƒ£ `.wukongrc` é»˜è®¤æ˜¯ã€Œéšå½¢çš„ã€

-   **æ²¡æœ‰å°±å®Œå…¨ä¸å½±å“**

-   ä¸æŠ¥é”™

-   ä¸æç¤º

-   ä¸å¼ºåˆ¶


ğŸ‘‰ ç”¨èµ·æ¥å’Œç°åœ¨ **ä¸€æ¨¡ä¸€æ ·**

---

### âœ… 2ï¸âƒ£ `.wukongrc` åªå½±å“ã€Œé«˜çº§èƒ½åŠ›ã€

**åªåœ¨è¿™äº›åœ°æ–¹ç”Ÿæ•ˆï¼š**

| åŠŸèƒ½ | æ˜¯å¦ä½¿ç”¨ rc |
| --- | --- |
| analyze | å¯é€‰ |
| overtime | å¯é€‰ |
| serve | âŒï¼ˆå³æ—¶è¡Œä¸ºï¼‰ |
| report | âœ… å¼ºçƒˆé€‚åˆ |
| CI / è‡ªåŠ¨åŒ– | âœ… |

---

### âœ… 3ï¸âƒ£ CLI å‚æ•°æ°¸è¿œä¼˜å…ˆ

```bash
wukong report --template monthly
```

ğŸ‘‰ **æ°¸è¿œè¦†ç›– `.wukongrc`**

ç”¨æˆ·å¿ƒç†ä¸Šæ˜¯å®‰å…¨çš„ã€‚

---

### âœ… 4ï¸âƒ£ æ–‡æ¡£é‡Œè¿™æ ·å†™ï¼ˆéå¸¸é‡è¦ï¼‰

åœ¨ README é‡Œç”¨ä¸€å¥è¯å°±å¤Ÿï¼š

> `.wukongrc` is optional.
> CLI flags always take precedence.

---

## å…­ã€ä½ å¦‚æœä¸åš `.wukongrc`ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

è¯´å®è¯ï¼š

-   å·¥å…· **ç°åœ¨ä¹Ÿå®Œå…¨èƒ½ç”¨**

-   ä½ ä¹Ÿä¸ä¼šè¢«å–·


ä½†æœªæ¥ä½ ä¼šé‡åˆ°ï¼š

-   report å‘½ä»¤å‚æ•°è¶Šæ¥è¶Šé•¿

-   CI é…ç½®å¾ˆä¸‘

-   ç”¨æˆ· copy/paste ä¸€å †å‚æ•°

-   å›¢é˜Ÿæ— æ³•å…±äº«åˆ†æè§„èŒƒ


ğŸ‘‰ åˆ°é‚£æ—¶ **ä½ ä¸€å®šä¼šè¡¥ rc**
è€Œä¸”æˆæœ¬æ›´é«˜ã€‚

---

## ä¸ƒã€ä¸€ä¸ªéå¸¸å®åœ¨çš„åˆ¤æ–­æ ‡å‡†ï¼ˆé€ä½ ï¼‰

ä½ å¯ä»¥ç”¨è¿™æ¡çº¿æ¥å†³å®šï¼š

> **â€œæˆ‘ä¼šä¸ä¼šåœ¨ä¸€å¹´åï¼Œè¿˜åœ¨åŒä¸€ä¸ªä»“åº“é‡Œåå¤è·‘è¿™ä¸ªå‘½ä»¤ï¼Ÿâ€**

-   âŒ ä¸ä¼š â†’ ä¸éœ€è¦ rc

-   âœ… ä¼š â†’ rc éå¸¸å€¼


å°±ä½ ç°åœ¨çš„è®¾è®¡æ¥çœ‹ï¼š

ğŸ‘‰ **ä½ æ˜æ˜¾æ˜¯æ‰“ç®—é•¿æœŸç”¨å®ƒçš„**

---

## å…«ã€æˆ‘çš„æœ€ç»ˆå»ºè®®ï¼ˆç«™åœ¨ä½œè€…ç«‹åœºï¼‰

> **ä¿ç•™ `.wukongrc` æ”¯æŒï¼Œä½†ï¼š**
>
> -   ä¸å®£ä¼ 
>
> -   ä¸å¼ºåˆ¶
>
> -   ä¸å¤æ‚
>
> -   ä¸è®©æ–°ç”¨æˆ·æ„ŸçŸ¥
>

è¿™æ ·ï¼š

-   æ–°ç”¨æˆ·ï¼š`wukong analyze`

-   è€ç”¨æˆ· / å›¢é˜Ÿï¼š`.wukongrc`

-   ä½ ï¼šä¸€æ¬¡è®¾è®¡ï¼Œé•¿æœŸå—ç›Š


---

æ”¯æŒ .wukonggitlogrc.jsï¼ˆæˆ– .cjs / .mjsï¼‰æ˜¯é«˜çº§ CLI å·¥å…·ï¼ˆå¦‚ Tailwind, Vite, Prettierï¼‰çš„æ ‡é…ã€‚

ä½¿ç”¨ .js åç¼€æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºï¼šå®ƒå…è®¸ç”¨æˆ·åœ¨é…ç½®ä¸­ä½¿ç”¨é€»è¾‘ï¼ˆä¾‹å¦‚é€šè¿‡ process.env è·å–å½“å‰ç”¨æˆ·ï¼Œæˆ–è€…åŠ¨æ€è®¡ç®—æ—¥æœŸï¼‰ã€‚

3. ä¸ºä»€ä¹ˆæ”¯æŒ .js å¾ˆæœ‰ç”¨ï¼Ÿ
æ”¯æŒ .js é…ç½®æ–‡ä»¶åï¼Œç”¨æˆ·å¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸åŒçš„åˆ†æ”¯åŠ¨æ€è®¾ç½®ç»Ÿè®¡èŒƒå›´ï¼š

```JavaScript

// ç”¨æˆ·é¡¹ç›®ä¸­çš„ .wukonggitlogrc.js
import { execSync } from 'child_process';

const currentBranch = execSync('git rev-parse --abbrev-ref HEAD').toString().trim();

export default {
  output: {
    // è‡ªåŠ¨æ ¹æ®åˆ†æ”¯åå‘½åè¾“å‡ºç›®å½•
    dir: `output-wukong-${currentBranch}`,
    formats: currentBranch === 'master' ? ['excel', 'json'] : ['text']
  }
};
```
æ³¨æ„äº‹é¡¹ï¼š
ESM vs CommonJSï¼šå¦‚æœä½ çš„å·¥å…·åŒ…æ˜¯ "type": "module"ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ .js é»˜è®¤å°±æ˜¯ ESMï¼Œéœ€è¦ç”¨ export defaultã€‚

å¼‚æ­¥åŠ è½½ï¼šå› ä¸º import() æ˜¯å¼‚æ­¥çš„ï¼Œä½ çš„ loadRcConfig å’Œ main å‡½æ•°å¿…é¡»ä½¿ç”¨ async/awaitã€‚

æ”¯æŒ .js ä¹‹åï¼Œä½ çš„é…ç½®ç³»ç»Ÿå°±è¾¾åˆ°äº†åƒ Webpack æˆ– Vite é‚£æ ·çš„ä¸“ä¸šæ°´å‡†äº†ã€‚ä½ æ˜¯å¦å·²ç»å‡†å¤‡å¥½å¤„ç† git log çš„æ•°æ®æŠ“å–éƒ¨åˆ†ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„äº‰è®ºã€‚ç®€å•ç›´æ¥çš„ç»“è®ºæ˜¯ï¼š**ä¸¤è€…åœ¨æŠ€æœ¯ä¸Šå®Œå…¨ç­‰ä»·ï¼Œä½†ç›®å‰ç¤¾åŒºçš„å…±è¯†å’Œå·¥ä¸šæ ‡å‡†æ›´å€¾å‘äºä½¿ç”¨ `.yml`ã€‚**

ä»¥ä¸‹æ˜¯æ·±åº¦å¯¹æ¯”å’Œé€‰æ‹©å»ºè®®ï¼š

### 1. å†å²æ¸Šæº

- **`.yaml`**ï¼šè¿™æ˜¯ YAML å®˜æ–¹æ¨èçš„åç¼€ã€‚YAML ä»£è¡¨ "YAML Ain't Markup Language"ã€‚æŒ‰ç…§æ–‡ä»¶ç±»å‹çš„å‘½åè§„èŒƒï¼Œå››ä½åç¼€èƒ½æ›´å®Œæ•´åœ°ä»£è¡¨å…¶èº«ä»½ã€‚
- **`.yml`**ï¼šèµ·æºäºæ—©æœŸçš„ Windows ç³»ç»Ÿï¼ˆDOS æ—¶ä»£ï¼‰ï¼Œå½“æ—¶é™åˆ¶æ–‡ä»¶åç¼€ååªèƒ½æœ‰ 3 ä½ï¼ˆå³è‘—åçš„ 8.3 æ–‡ä»¶åæ ¼å¼ï¼Œå¦‚ `.html` å¿…é¡»å†™æˆ `.htm`ï¼‰ã€‚

### 2. ç°çŠ¶ï¼šè°åœ¨ç”¨ä»€ä¹ˆï¼Ÿ

ç›®å‰ä¸»æµå¼€æºé¡¹ç›®å’Œå·¥å…·çš„åå¥½å¦‚ä¸‹ï¼š

| **å·¥å…·/å¹³å°**        | **é»˜è®¤/æ¨èåç¼€**                                            |
| -------------------- | ------------------------------------------------------------ |
| **GitHub Actions**   | å¿…é¡»ä½¿ç”¨ `.yml` æˆ– `.yaml` (ä¸¤è€…éƒ½è¯†åˆ«ï¼Œä½†æ–‡æ¡£ç¤ºä¾‹å¤šä¸º `.yml`) |
| **Docker Compose**   | å®˜æ–¹æ–‡æ¡£å¸¸ç”¨ `docker-compose.yml`                            |
| **Ansible**          | å®˜æ–¹æ–‡æ¡£æ˜ç¡®æ¨èä½¿ç”¨ `.yml`                                  |
| **Kubernetes (k8s)** | å¤§å¤šæ•°ç¤ºä¾‹ä½¿ç”¨ `.yaml`                                       |
| **PNPM / Prettier**  | é»˜è®¤ç”Ÿæˆæˆ–æŸ¥æ‰¾ `.yml`                                        |

### 3. ä¸ºä»€ä¹ˆåœ¨ Node.js/CLI å¼€å‘ä¸­æ¨è `.yml`ï¼Ÿ

ä½œä¸º `wukong-gitlog` çš„å¼€å‘è€…ï¼Œå»ºè®®ä½ ä¼˜å…ˆæ¨è `.yml`ï¼Œç†ç”±æœ‰ä¸‰ï¼š

1. **è¾“å…¥æ›´çŸ­**ï¼šåœ¨ç»ˆç«¯æ‰‹åŠ¨è¾“å…¥æ–‡ä»¶åæ—¶ï¼Œå°‘ä¸€ä¸ªå­—æ¯ç¡®å®æ›´é«˜æ•ˆã€‚
2. **ç¤¾åŒºæƒ¯ä¾‹**ï¼šåœ¨ JS/TS ç”Ÿæ€ä¸­ï¼ˆå¦‚ `pnpm-lock.yaml` é™¤å¤–ï¼‰ï¼Œå¤§å¤šæ•°é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `.prettierrc.yml`, `.esslintrc.yml`ï¼‰ä¹ æƒ¯ç”¨ 3 ä½ã€‚
3. **è§†è§‰ç»Ÿä¸€**ï¼šå¾ˆå¤šå¼€å‘è€…è§‰å¾— 3 ä½åç¼€ï¼ˆ.js, .ts, .md, .py, .rbï¼‰åœ¨æ–‡ä»¶åˆ—è¡¨ä¸­çœ‹èµ·æ¥æ›´æ•´é½ã€‚

------

### 4. ä½ çš„ä»£ç åº”è¯¥å¦‚ä½•å…¼å®¹ï¼Ÿï¼ˆç”Ÿäº§çº§å»ºè®®ï¼‰

æ—¢ç„¶ä½ æ˜¯å†™ CLI å·¥å…·ï¼Œ**ç»å¯¹ä¸è¦è®©ç”¨æˆ·åšé€‰æ‹©é¢˜**ã€‚ä½ çš„ç¨‹åºåº”è¯¥è¡¨ç°å‡ºâ€œå¤§åº¦â€ï¼š**åŒæ—¶æ”¯æŒä¸¤è€…ï¼Œä½†æ–‡æ¡£å¼•å¯¼ç”¨ä¸€ç§ã€‚**

ä½ ä¹‹å‰çš„ `configStore.mjs` å·²ç»åšå¾—å¾ˆå¥½äº†ï¼Œä½†æˆ‘å»ºè®®å¾®è°ƒ `RC_NAMES` çš„é¡ºåºï¼ŒæŠŠæœ€å¯èƒ½çš„æ’åœ¨å‰é¢ä»¥æé«˜æœç´¢æ•ˆç‡ï¼š

JavaScript

```
// æ¨èçš„æŸ¥æ‰¾é¡ºåºï¼šJSä¼˜å…ˆï¼ˆå› ä¸ºçµæ´»ï¼‰ï¼Œç„¶åæ˜¯å¸¸ç”¨çš„ yml
const RC_NAMES = [
  '.wukonggitlogrc.js',
  '.wukonggitlogrc.mjs',
  '.wukonggitlogrc.yml',  // æ”¾åœ¨ .yaml å‰é¢ï¼Œå› ä¸ºæ›´å¸¸ç”¨
  '.wukonggitlogrc.yaml',
  '.wukonggitlogrc.json',
  '.wukonggitlogrc'       // æ— åç¼€æ”¾åœ¨æœ€å
]
```

### æ€»ç»“å»ºè®®

- **ä½ çš„æ–‡æ¡£/Helpè¯´æ˜**ï¼šç»Ÿä¸€å†™ `.wukonggitlogrc.yml`ã€‚
- **ä½ çš„ `init` å‘½ä»¤**ï¼šé»˜è®¤ç”Ÿæˆ `.wukonggitlogrc.yml`ã€‚
- **ä½ çš„ä»£ç é€»è¾‘**ï¼šä¿æŒå¯¹ä¸¤è€…çš„å…¼å®¹ï¼Œè¿™æ ·ç”¨æˆ·ä»åˆ«å¤„æ‹·è´è¿‡æ¥çš„ `.yaml` æ–‡ä»¶ä¹Ÿä¸è‡³äºæŠ¥é”™ã€‚
